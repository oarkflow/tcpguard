{
    "rules": [
        {
            "name": "rate_limit_rule",
            "conditions": [
                {
                    "type": "request_count",
                    "config": {
                        "uri": "/api/",
                        "methods": [ "GET", "POST" ],
                        "threshold": 1,
                        "unit": "second",
                        "operator": ">"
                    }
                }
            ],
            "actions": {
                "rate_limit_api": { },
                "temp_ban_api": { }
            }
        },
        {
            "name": "admin_restriction_rule",
            "conditions": [
                {
                    "type": "request_count",
                    "config": {
                        "uri": "/api/admin/",
                        "methods": [ "GET", "POST" ],
                        "threshold": 1,
                        "unit": "second",
                        "operator": ">"
                    }
                }
            ],
            "actions": {
                "restrict_admin": { },
                "warning_admin": { }
            }
        }
    ],
    "actions": [
        {
            "type": "rate_limit",
            "name": "suspicious_path",
            "config": {
                "base_delay": 5,
                "jitter_range": 2000
            },
            "response": {
                "status_code": 429,
                "body": "Suspicious Requests"
            }
        },
        {
            "type": "rate_limit",
            "name": "rate_limit_api",
            "config": {
                "base_delay": 5,
                "jitter_range": 2000
            },
            "response": {
                "status_code": 429,
                "body": "Too Many Requests"
            }
        },
        {
            "type": "temp_ban",
            "name": "temp_ban_api",
            "config": {
                "duration": "1m"
            },
            "response": {
                "status_code": 429,
                "body": "Temporarily Banned"
            }
        },
        {
            "type": "restrict",
            "name": "restrict_admin",
            "config": { },
            "response": {
                "status_code": 403,
                "body": "Access Restricted"
            }
        },
        {
            "type": "warning",
            "name": "warning_admin",
            "config": { },
            "response": {
                "status_code": 200,
                "body": "Warning Logged"
            }
        }
    ]
}
