{
    "name": "ddosDetection",
    "type": "ddos",
    "enabled": true,
    "params": {
        "requestsPerMinute": 50
    },
    "actions": [
        {
            "type": "temporary_ban",
            "duration": "10m",
            "trigger": {
                "threshold": 10,
                "within": "1m",
                "scope": "client",
                "key": "ddos_violations"
            },
            "response": {
                "status": 403,
                "message": "Temporary ban due to suspected DDoS activity."
            }
        },
        {
            "type": "rate_limit",
            "limit": "50 rpm",
            "duration": "1m",
            "response": {
                "status": 429,
                "message": "Too many global requests. Please slow down."
            }
        }
    ]
}
