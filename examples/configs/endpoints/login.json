{
    "name": "login",
    "endpoint": "/api/login",
    "rateLimit": {
        "requestsPerMinute": 5,
        "burst": 2
    },
    "actions": [
        {
            "type": "jitter_warning",
            "jitterRangeMs": [ 500, 2000 ],
            "response": {
                "status": 429,
                "message": "Too many login attempts. Please wait a moment."
            },
            "notify": {
                "channel": "log",
                "topic": "login-security",
                "message": "Multiple login attempts from {{clientIP}} on {{endpoint}}",
                "details": {
                    "severity": "low",
                    "user_id": "{{userID}}"
                }
            }
        },
        {
            "type": "rate_limit",
            "response": {
                "status": 429,
                "message": "Rate limit exceeded. Please try again later."
            },
            "notify": {
                "channel": "webhook",
                "topic": "https://your-security-system.com/api/alerts",
                "message": "Login rate limit exceeded for {{clientIP}}",
                "details": {
                    "severity": "medium",
                    "endpoint": "{{endpoint}}",
                    "user_id": "{{userID}}",
                    "timestamp": "{{timestamp}}"
                }
            }
        },
        {
            "type": "temporary_ban",
            "duration": "15m",
            "trigger": {
                "key": "failedLogins",
                "threshold": 5,
                "within": "2m"
            },
            "response": {
                "status": 403,
                "message": "You are temporarily banned due to excessive failed logins."
            },
            "notify": {
                "channel": "slack",
                "topic": "https://hooks.slack.com/services/YOUR/WEBHOOK/URL",
                "message": "⚠️ Login Security Alert: Client {{clientIP}} banned for 15 minutes due to failed login attempts",
                "details": {
                    "severity": "high",
                    "endpoint": "{{endpoint}}",
                    "user_attempted": "{{userID}}",
                    "rule": "{{ruleName}}",
                    "action": "{{actionType}}",
                    "banned_until": "15 minutes",
                    "timestamp": "{{timestamp}}"
                }
            }
        }
    ]
}
