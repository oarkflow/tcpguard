{
    "name": "ddosDetection",
    "type": "ddos",
    "enabled": true,
    "priority": 100,
    "params": {
        "requestsPerMinute": 50
    },
    "actions": [
        {
            "type": "temporary_ban",
            "priority": 10,
            "duration": "10m",
            "trigger": {
                "threshold": 10,
                "within": "1m",
                "scope": "client",
                "key": "ddos_violations"
            },
            "response": {
                "status": 403,
                "message": "Temporary ban due to suspected DDoS activity."
            },
            "notify": {
                "channel": "slack",
                "topic": "default",
                "message": "ðŸš¨ DDoS Detection: Client {{clientIP}} temporarily banned for 10 minutes",
                "details": {
                    "severity": "high",
                    "rule": "{{ruleName}}",
                    "endpoint": "{{endpoint}}",
                    "action": "{{actionType}}",
                    "timestamp": "{{timestamp}}"
                }
            }
        },
        {
            "type": "rate_limit",
            "priority": 5,
            "limit": "50 rpm",
            "duration": "1m",
            "response": {
                "status": 429,
                "message": "Too many global requests. Please slow down."
            },
            "notify": {
                "channel": "log",
                "topic": "ddos-protection",
                "message": "Rate limit applied to {{clientIP}} - suspected DDoS pattern detected",
                "details": {
                    "severity": "medium",
                    "rule": "{{ruleName}}",
                    "client": "{{clientIP}}"
                }
            }
        }
    ]
}
