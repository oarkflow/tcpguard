{
    "name": "mitmDetection",
    "type": "mitm",
    "enabled": true,
    "priority": 90,
    "params": {
        "indicators": [
            "invalid_ssl_certificate",
            "abnormal_tls_handshake",
            "suspicious_user_agent"
        ],
        "suspiciousUserAgents": [ "scanner", "bot" ]
    },
    "actions": [
        {
            "type": "permanent_ban",
            "priority": 10,
            "response": {
                "status": 403,
                "message": "Connection blocked due to security concerns (MITM detected)."
            },
            "notify": {
                "channel": "slack",
                "topic": "security",
                "message": "ðŸ”´ CRITICAL SECURITY ALERT: MITM Attack detected from {{clientIP}} - Permanent ban issued",
                "details": {
                    "severity": "critical",
                    "event_type": "mitm_attack",
                    "client_ip": "{{clientIP}}",
                    "endpoint": "{{endpoint}}",
                    "rule": "{{ruleName}}",
                    "action": "{{actionType}}",
                    "timestamp": "{{timestamp}}",
                    "requires_immediate_action": "true"
                }
            }
        }
    ]
}
