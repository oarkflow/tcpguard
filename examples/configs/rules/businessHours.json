{
    "name": "businessHours",
    "type": "pipeline",
    "enabled": true,
    "priority": 40,
    "pipeline": {
        "nodes": [
            {
                "id": "check_endpoint",
                "type": "utility",
                "function": "checkEndpoint",
                "params": {
                    "endpoint": "/api/login"
                }
            },
            {
                "id": "get_time",
                "type": "utility",
                "function": "getCurrentTime"
            },
            {
                "id": "parse_start",
                "type": "utility",
                "function": "parseTime",
                "params": {
                    "timeString": "09:00",
                    "layout": "15:04"
                }
            },
            {
                "id": "parse_end",
                "type": "utility",
                "function": "parseTime",
                "params": {
                    "timeString": "12:00",
                    "layout": "15:04"
                }
            },
            {
                "id": "check_hours",
                "type": "condition",
                "function": "checkBusinessHours",
                "params": {
                    "timezone": "UTC"
                }
            }
        ],
        "edges": [
            { "from": "check_endpoint", "to": "get_time" },
            { "from": "get_time", "to": "parse_start" },
            { "from": "parse_start", "to": "parse_end" },
            { "from": "parse_end", "to": "check_hours" }
        ]
    },
    "actions": [
        {
            "type": "temporary_ban",
            "priority": 7,
            "duration": "1h",
            "response": {
                "status": 403,
                "message": "Login attempted outside business hours."
            },
            "notify": {
                "channel": "log",
                "topic": "access-control",
                "message": "Login attempt outside business hours from {{clientIP}} on {{endpoint}}",
                "details": {
                    "severity": "medium",
                    "user_id": "{{userID}}",
                    "rule": "{{ruleName}}",
                    "action": "{{actionType}}",
                    "timestamp": "{{timestamp}}",
                    "reason": "access_outside_business_hours"
                }
            }
        }
    ]
}
